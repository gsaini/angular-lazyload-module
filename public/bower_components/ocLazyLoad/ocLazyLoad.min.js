/**
 * original copyright: Andy Grom (https://github.com/AndyGrom/loadOnDemand)
 * rewrite by: Olivier Combe (https://github.com/ocombe/ocLazyLoad)
 */
(function(){"use strict";function n(t){var n=[];angular.forEach(t.requires,function(t){if(e.indexOf(t)===-1){n.push(t)}});return n}function r(e){try{angular.module(e)}catch(t){if(/No module/.test(t)||t.message.indexOf("$injector:nomod")>-1){return false}}return true}function i(t,n,r){var i,s,o,u,a,f,l,c;if(n){var h=[];for(o=n.length-1;o>=0;o--){a=n[o];e.push(a);f=angular.module(a);h=h.concat(f._runBlocks);try{for(u=f._invokeQueue,i=0,s=u.length;i<s;i++){l=u[i];if(t.hasOwnProperty(l[0])){c=t[l[0]]}else{return r.error("unsupported provider "+l[0])}c[l[1]].apply(c,l[2])}}catch(p){if(p.message){p.message+=" from "+a}r.error(p.message);throw p}n.pop()}angular.forEach(h,function(e){t.$injector.invoke(e)})}return null}function s(t){function u(e){return e&&n.push(e)}var n=[t],r,i,s=["ng:app","ng-app","x-ng-app","data-ng-app"],o=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;angular.forEach(s,function(e){s[e]=true;u(document.getElementById(e));e=e.replace(":","\\:");if(t.querySelectorAll){angular.forEach(t.querySelectorAll("."+e),u);angular.forEach(t.querySelectorAll("."+e+"\\:"),u);angular.forEach(t.querySelectorAll("["+e+"]"),u)}});angular.forEach(n,function(e){if(!r){var n=" "+t.className+" ";var u=o.exec(n);if(u){r=e;i=(u[2]||"").replace(/\s+/g,",")}else{angular.forEach(e.attributes,function(t){if(!r&&s[t.name]){r=e;i=t.value}})}}});if(r){(function a(t){if(e.indexOf(t)===-1){e.push(t);var n=angular.module(t);angular.forEach(n.requires,a)}})(i)}}var e=["ng","ngAnimate"];var t=angular.module("oc.lazyLoad",["ng"]);t.provider("$ocLazyLoad",["$controllerProvider","$provide","$compileProvider","$filterProvider","$injector",function(t,o,u,a,f){var l={},c,h={$controllerProvider:t,$compileProvider:u,$filterProvider:a,$provide:o,$injector:f};this.$get=["$timeout","$log","$q",function(t,s,o){return{getModuleConfig:function(e){if(!l[e]){return null}return l[e]},setModuleConfig:function(e){l[e.name]=e;return e},getModules:function(){return e},load:function(u){function v(i,o){function h(e){if(e){var n=f.indexOf(e);if(n>-1){f.splice(n,1)}}if(f.length===0){t(function(){o(i)})}}if(e.indexOf(i)>-1){return o()}var u=angular.module(i),f=n(u);var p=n(u);angular.forEach(p,function(e){l.push(e);if(r(e)){return h(e)}var t=a.getConfig(e);if(t&&typeof t.files!=="undefined"){c(t.files,function(){v(e,function(t){h(t)})})}else{s.warn('module "'+e+"' not loaded and not configured");h(e)}return null});if(p.length===0){h()}return null}var a=this,f,l=[],p=o.defer();if(typeof u==="string"){f=a.getModuleConfig(u)}else if(typeof u==="object"&&typeof u.name!=="undefined"){f=a.setModuleConfig(u);u=u.name}l.push=function(e){if(this.indexOf(e)===-1){Array.prototype.push.apply(this,arguments)}};if(!f){var d='Module "'+u+'" not configured';s.error(d);throw d}c(f.files,function(){l.push(u);v(u,function(){i(h,l,s);t(function(){p.resolve(f)})})});return p.promise}}}];this.config=function(e){if(typeof e.asyncLoader==="undefined"){throw"You need to define an async loader such as requireJS or script.js"}c=e.asyncLoader;s(angular.element(window.document));if(typeof e.modules!=="undefined"){if(angular.isArray(e.modules)){angular.forEach(e.modules,function(e){l[e.name]=e})}else{l[e.modules.name]=e.modules}}}}]);t.directive("ocLazyLoad",["$http","$log","$ocLazyLoad","$compile","$timeout","$templateCache",function(e,t,n,r,i,s){return{link:function(i,o,u){function l(){if(a){a.$destroy();a=null}o.html("")}function c(n,r){var i;if(typeof (i=s.get(n))!=="undefined"){r(i)}else{e.get(n).success(function(e){s.put("view:"+n,e);r(e)}).error(function(e){t.error('Error load template "'+n+"': "+e)})}}var a;var f=i.$eval(u.ocLazyLoad).onload||"";i.$watch(u.ocLazyLoad,function(e){if(e){n.load(e).then(function(e){if(!e.template){return}c(e.template,function(e){a=i.$new();o.html(e);var t=o.contents();var n=r(t);n(a);a.$emit("$includeContentLoaded");a.$eval(f)})})}else{l()}})}}}])})()